import{a as q}from"./chunk-FDXNLMBA.js";import{c as P,e as N,i as $}from"./chunk-HI7UVJRH.js";import"./chunk-INV6E4XJ.js";import{j as Z,k as T}from"./chunk-I6DLYWHU.js";import{$a as F,A as E,Aa as o,B as u,Ga as a,Gb as D,M as r,Ma as M,Qa as A,R as w,V as _,a as S,ab as d,b as C,bb as v,cb as j,db as V,eb as z,fb as H,jb as X,l as g,lb as Y,m as I,mb as B,nb as W,ob as U,p as f,qb as s,sb as m,t as y,ub as R,ya as k}from"./chunk-PVBC43KC.js";var l=class l{constructor(e){this.router=e;this.destroy$=new g;this.isDebugMode=!0;this.navigationConfig={routes:["/","/music","/about","/contact","/credits","/top","/bottom"],defaultRoute:"/"};this.navigationState$=new I({currentIndex:0,totalPages:this.navigationConfig.routes.length,isTransitioning:!1,currentRoute:this.navigationConfig.defaultRoute,previousRoute:null});this.errorSubject=new g;this.isDebugMode&&(console.log("[MobileNavigation] Service initialized"),console.log("[MobileNavigation] Available routes:",this.navigationConfig.routes)),this.initializeRouteListener(),this.syncCurrentRouteWithState()}initializeRouteListener(){this.router.events.pipe(E(e=>e instanceof P),r(this.destroy$)).subscribe(e=>{let t=e.urlAfterRedirects,i=t.startsWith("/mobile")?t.substring(7)||"/":t;this.updateStateFromRoute(i),this.isDebugMode&&(console.log(`[MobileNavigation] Route changed to: ${i}`),console.log("[MobileNavigation] Current state:",this.navigationState$.value))})}syncCurrentRouteWithState(){let e=this.router.url,t=e.startsWith("/mobile")?e.substring(7)||"/":e;this.updateStateFromRoute(t),this.isDebugMode&&(console.log(`[MobileNavigation] Initial route: ${t}`),console.log("[MobileNavigation] Initial state:",this.navigationState$.value))}updateStateFromRoute(e){let t=this.navigationConfig.routes.findIndex(i=>i===e);if(t!==-1){let i=this.navigationState$.value;this.navigationState$.next(C(S({},i),{currentIndex:t,previousRoute:i.currentRoute,currentRoute:e}))}else this.isDebugMode&&console.warn(`[MobileNavigation] Route not found in config: ${e}`)}handleError(e,t){this.isDebugMode&&console.error(`[MobileNavigation] ${e}: ${t}`),this.errorSubject.next({type:e,message:t})}getCurrentPageIndex(){return this.navigationState$.pipe(y(e=>e.currentIndex),u(e=>(this.handleError("STATE_ERROR",`Error getting current page index: ${e}`),f(0))))}getCurrentRoute(){return this.navigationState$.pipe(y(e=>e.currentRoute),u(e=>(this.handleError("STATE_ERROR",`Error getting current route: ${e}`),f(this.navigationConfig.defaultRoute))))}nextPage(){try{let e=this.navigationState$.value;if(e.isTransitioning){this.isDebugMode&&console.log("[MobileNavigation] Already transitioning, ignoring nextPage request");return}let t=(e.currentIndex+1)%e.totalPages;this.isDebugMode&&console.log(`[MobileNavigation] Navigating to next page: ${t}`),this.navigateToPage(t)}catch(e){this.handleError("STATE_ERROR",`Error navigating to next page: ${e instanceof Error?e.message:String(e)}`)}}previousPage(){try{let e=this.navigationState$.value;if(e.isTransitioning){this.isDebugMode&&console.log("[MobileNavigation] Already transitioning, ignoring previousPage request");return}let t=(e.currentIndex-1+e.totalPages)%e.totalPages;this.isDebugMode&&console.log(`[MobileNavigation] Navigating to previous page: ${t}`),this.navigateToPage(t)}catch(e){this.handleError("STATE_ERROR",`Error navigating to previous page: ${e instanceof Error?e.message:String(e)}`)}}navigateToPage(e){try{if(e<0||e>=this.navigationConfig.routes.length){this.handleError("INDEX_ERROR",`Invalid page index: ${e}`);return}let t=this.navigationState$.value;if(t.isTransitioning){this.isDebugMode&&console.log("[MobileNavigation] Already transitioning, ignoring navigateToPage request");return}if(e===t.currentIndex){this.isDebugMode&&console.log(`[MobileNavigation] Already on page ${e}, ignoring navigation`);return}let i=this.navigationConfig.routes[e];this.isDebugMode&&console.log(`[MobileNavigation] Navigating to route: ${i} (index: ${e})`),this.setTransitioning(!0),this.router.navigate(["/mobile"+i]).then(()=>{this.updateCurrentIndex(e,i),setTimeout(()=>{this.setTransitioning(!1)},500)}).catch(n=>{this.handleError("ROUTE_ERROR",`Error navigating to route ${i}: ${n instanceof Error?n.message:String(n)}`),this.setTransitioning(!1)})}catch(t){this.handleError("STATE_ERROR",`Error in navigateToPage: ${t instanceof Error?t.message:String(t)}`),this.setTransitioning(!1)}}updateCurrentIndex(e,t){try{let i=this.navigationState$.value;this.navigationState$.next(C(S({},i),{currentIndex:e,previousRoute:i.currentRoute,currentRoute:t})),this.isDebugMode&&console.log(`[MobileNavigation] Updated current index to ${e} and route to ${t}`)}catch(i){this.handleError("STATE_ERROR",`Error updating current index: ${i instanceof Error?i.message:String(i)}`)}}setTransitioning(e){try{let t=this.navigationState$.value;if(t.isTransitioning===e)return;this.navigationState$.next(C(S({},t),{isTransitioning:e})),this.isDebugMode&&console.log(`[MobileNavigation] Set transitioning state to ${e}`)}catch(t){this.handleError("STATE_ERROR",`Error setting transitioning state: ${t instanceof Error?t.message:String(t)}`)}}getNavigationState(){return this.navigationState$.asObservable().pipe(u(e=>(this.handleError("STATE_ERROR",`Error getting navigation state: ${e}`),f({currentIndex:0,totalPages:this.navigationConfig.routes.length,isTransitioning:!1,currentRoute:this.navigationConfig.defaultRoute,previousRoute:null}))))}getErrors(){return this.errorSubject.asObservable()}canNavigate(){return this.navigationState$.pipe(y(e=>!e.isTransitioning),u(e=>(this.handleError("STATE_ERROR",`Error checking navigation availability: ${e}`),f(!1))))}resetNavigation(){try{this.isDebugMode&&console.log("[MobileNavigation] Resetting navigation"),this.navigateToPage(0)}catch(e){this.handleError("STATE_ERROR",`Error resetting navigation: ${e instanceof Error?e.message:String(e)}`)}}ngOnDestroy(){this.isDebugMode&&console.log("[MobileNavigation] Destroying service"),this.destroy$.next(),this.destroy$.complete()}};l.\u0275fac=function(t){return new(t||l)(_(N))},l.\u0275prov=w({token:l,factory:l.\u0275fac,providedIn:"root"});var h=l;var ee=["cube"],p=class p{constructor(e,t,i,n){this.cdr=e;this.router=t;this.audioService=i;this.navigationService=n;this.destroy$=new g;this.isDebugMode=!0;this.touchStartX=0;this.touchStartY=0;this.currentPage=0;this.totalPages=6;this.cubeDimensions={width:0,height:0,depth:0};this.currentFace="front";this.isTransitioning=!1;this.routeFaceMap={"/":"front","/music":"right","/about":"back","/contact":"left","/top":"top","/bottom":"bottom"}}ngOnInit(){this.isDebugMode&&console.log("[CubicContainer] Initializing component"),this.initializeComponent()}ngAfterViewInit(){this.isDebugMode&&console.log("[CubicContainer] After view init"),this.updateCubeDimensions()}ngOnDestroy(){this.isDebugMode&&console.log("[CubicContainer] Destroying component"),this.destroy$.next(),this.destroy$.complete(),this.routerSubscription&&this.routerSubscription.unsubscribe()}initializeComponent(){this.routerSubscription=this.router.events.pipe(E(e=>e instanceof P),r(this.destroy$)).subscribe(e=>{let t=e.urlAfterRedirects,i=this.getTargetFace(t);i!==this.currentFace&&this.rotateCube(i)}),this.navigationService.getCurrentPageIndex().pipe(r(this.destroy$)).subscribe(e=>{this.currentPage=e,this.cdr.markForCheck()})}handleResize(){this.updateCubeDimensions(),this.cdr.markForCheck()}onTouchStart(e){this.touchStartX=e.touches[0].clientX,this.touchStartY=e.touches[0].clientY}onTouchMove(e){if(this.isTransitioning)return;let t=e.touches[0].clientX,i=e.touches[0].clientY,n=t-this.touchStartX,c=i-this.touchStartY;Math.abs(n)>Math.abs(c)&&(n>50?this.navigationService.previousPage():n<-50&&this.navigationService.nextPage())}onWheel(e){e.preventDefault(),!this.isTransitioning&&(e.deltaY>0?this.navigationService.nextPage():this.navigationService.previousPage())}updateCubeDimensions(){if(!this.cubeElement)return;let t=this.cubeElement.nativeElement.getBoundingClientRect();this.cubeDimensions={width:t.width,height:t.height,depth:Math.min(t.width,t.height)/2},this.isDebugMode&&console.log("[CubicContainer] Cube dimensions updated:",this.cubeDimensions)}rotateCube(e){this.isDebugMode&&console.log(`[CubicContainer] Rotating cube to face: ${e}`),this.isTransitioning=!0,this.currentFace=e,this.cdr.markForCheck(),setTimeout(()=>{this.isTransitioning=!1,this.cdr.markForCheck()},500)}getTargetFace(e){let t=e.split("?")[0].split("#")[0];return this.routeFaceMap[t]||"front"}};p.\u0275fac=function(t){return new(t||p)(a(D),a(N),a(q),a(h))},p.\u0275cmp=M({type:p,selectors:[["app-cubic-container"]],viewQuery:function(t,i){if(t&1&&B(ee,5),t&2){let n;W(n=U())&&(i.cubeElement=n.first)}},hostBindings:function(t,i){t&1&&X("resize",function(){return i.handleResize()},k)("touchstart",function(c){return i.onTouchStart(c)})("touchmove",function(c){return i.onTouchMove(c)})("wheel",function(c){return i.onWheel(c)})},decls:9,vars:14,consts:[["cube",""],[1,"cube-container"],[1,"cube"],[1,"face","front"],[1,"face","right"],[1,"face","back"],[1,"face","left"],[1,"face","top"],[1,"face","bottom"]],template:function(t,i){t&1&&(V(0,"div",1,0)(2,"div",2),H(3,"div",3)(4,"div",4)(5,"div",5)(6,"div",6)(7,"div",7)(8,"div",8),z()()),t&2&&(o(2),s("transitioning",i.isTransitioning),o(),s("active",i.currentFace==="front"),o(),s("active",i.currentFace==="right"),o(),s("active",i.currentFace==="back"),o(),s("active",i.currentFace==="left"),o(),s("active",i.currentFace==="top"),o(),s("active",i.currentFace==="bottom"))},dependencies:[T,$],styles:[".cube-container[_ngcontent-%COMP%]{width:100%;height:100%;perspective:1000px;display:flex;justify-content:center;align-items:center}.cube[_ngcontent-%COMP%]{width:100%;height:100%;position:relative;transform-style:preserve-3d;transition:transform .5s ease}.cube.transitioning[_ngcontent-%COMP%]{transition:transform .5s ease}.face[_ngcontent-%COMP%]{position:absolute;width:100%;height:100%;background:#000c;border:1px solid rgba(255,255,255,.1);display:flex;justify-content:center;align-items:center;backface-visibility:hidden}.face.active[_ngcontent-%COMP%]{background:#000000e6;border-color:#ffffff4d}.front[_ngcontent-%COMP%]{transform:translateZ(50%)}.right[_ngcontent-%COMP%]{transform:rotateY(90deg) translateZ(50%)}.back[_ngcontent-%COMP%]{transform:rotateY(180deg) translateZ(50%)}.left[_ngcontent-%COMP%]{transform:rotateY(-90deg) translateZ(50%)}.top[_ngcontent-%COMP%]{transform:rotateX(90deg) translateZ(50%)}.bottom[_ngcontent-%COMP%]{transform:rotateX(-90deg) translateZ(50%)}"],changeDetection:0});var O=p;function te(x,e){if(x&1&&(d(0,"div",2)(1,"div",3)(2,"p"),m(3),v(),d(4,"p"),m(5),v(),d(6,"p"),m(7),v(),d(8,"p"),m(9),v()()()),x&2){let t=Y();o(3),R("Current Page: ",t.navigationState.currentPage),o(2),R("Total Pages: ",t.navigationState.totalPages),o(2),R("Transitioning: ",t.navigationState.isTransitioning),o(2),R("Current Route: ",t.navigationState.currentRoute)}}var b=class b{constructor(e,t){this.navigationService=e;this.cdr=t;this.destroy$=new g;this.isDebugMode=!1;this.navigationState={currentPage:0,totalPages:6,isTransitioning:!1,currentRoute:"/",previousRoute:null}}ngOnInit(){this.isDebugMode&&console.log("[MobileView] Initializing component"),this.setupNavigationSubscription(),this.setupErrorHandling()}setupNavigationSubscription(){this.navigationService.getNavigationState().pipe(r(this.destroy$),u(e=>(console.error("[MobileView] Error in navigation subscription:",e),[]))).subscribe(e=>{this.isDebugMode&&console.log("[MobileView] Navigation state updated:",e),this.navigationState={currentPage:e.currentIndex,totalPages:e.totalPages,isTransitioning:e.isTransitioning,currentRoute:e.currentRoute,previousRoute:e.previousRoute},this.cdr.markForCheck()})}setupErrorHandling(){this.navigationService.getErrors().pipe(r(this.destroy$)).subscribe(e=>{console.error(`[MobileView] Navigation error (${e.type}):`,e.message)})}navigateNext(){this.isDebugMode&&console.log("[MobileView] Navigating to next page"),this.navigationService.nextPage()}navigatePrevious(){this.isDebugMode&&console.log("[MobileView] Navigating to previous page"),this.navigationService.previousPage()}navigateToPage(e){this.isDebugMode&&console.log(`[MobileView] Navigating to page: ${e}`),this.navigationService.navigateToPage(e)}ngOnDestroy(){this.isDebugMode&&console.log("[MobileView] Destroying component"),this.destroy$.next(),this.destroy$.complete()}};b.\u0275fac=function(t){return new(t||b)(a(h),a(D))},b.\u0275cmp=M({type:b,selectors:[["app-mobile-view"]],decls:3,vars:1,consts:[[1,"mobile-container"],["class","debug-panel",4,"ngIf"],[1,"debug-panel"],[1,"debug-info"]],template:function(t,i){t&1&&(d(0,"div",0),j(1,"app-cubic-container"),A(2,te,10,4,"div",1),v()),t&2&&(o(2),F("ngIf",i.isDebugMode))},dependencies:[T,Z,$,O],styles:[".mobile-container[_ngcontent-%COMP%]{position:fixed;inset:0;width:100vw;height:100vh;overflow:hidden;background:#000;display:flex;justify-content:center;align-items:center}.debug-panel[_ngcontent-%COMP%]{position:fixed;bottom:10px;left:10px;background:#000000b3;color:#0f0;font-family:monospace;padding:10px;border-radius:5px;border:1px solid #00ff00;font-size:12px;z-index:9999;max-width:300px;pointer-events:none}.debug-info[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:3px 0}"],changeDetection:0});var G=b;export{G as MobileViewComponent};
